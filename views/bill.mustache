<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/static/css/bootstrap-datepicker.min.css">
    <link rel="stylesheet" href="/static/css/bootstrap-select.min.css">
    <title>{{AppTitle}}</title>
  </head>
  <body>
    <div class="container">
      <h1>{{AppTitle}}</h1>
      <h2>{{CurrentUser.FullName}}</h2>
      {{#Bill}}<h2>Lasku #{{BillID}}</h2>{{/Bill}}
      {{^Bill}}<h2>Uusi lasku</h2>{{/Bill}}
      <form id="bill-form" enctype="multipart/form-data"
            {{#Bill}}method="POST" action="/bill/{{BillID}}"{{/Bill}}
            {{^Bill}}method="POST" action="/bill"{{/Bill}}>
        <div class="btn-group">
          <input type="submit" class="btn btn-lg btn-success" value="Tallenna">
          <a class="btn btn-lg btn-warning" href="/{{#Bill}}bill/{{BillID}}{{/Bill}}">Peruuta</a>
          <a class="btn btn-lg btn-info" href="/">Takaisin</a>
          {{#Bill}}
          {{#PrevBillID}}
          <a class="btn btn-lg btn-primary" href="/bill/{{PrevBillID}}">
            <span class="glyphicon glyphicon-arrow-left" title="Edellinen"></span>
          </a>
          {{/PrevBillID}}
          {{^PrevBillID}}
          <button class="btn btn-lg btn-primary disabled">
            <span class="glyphicon glyphicon-arrow-left" title="Edellinen"></span>
          </button>
          {{/PrevBillID}}
          {{#NextBillID}}
          <a class="btn btn-lg btn-primary" href="/bill/{{NextBillID}}">
            <span class="glyphicon glyphicon-arrow-right" title="Seuraava"></span>
          </a>
          {{/NextBillID}}
          {{^NextBillID}}
          <button class="btn btn-lg btn-primary disabled">
            <span class="glyphicon glyphicon-arrow-right" title="Seuraava"></span>
          </button>
          {{/NextBillID}}
          {{/Bill}}
        </div>
        <table class="table table-striped">
          <tr>
            <th>Maksaja:</th>
            <td>
              {{#admin}}
              <select class="form-control" name="PaidUser.id" value="{{#Bill}}{{PaidUser.id}}{{/Bill}}">
                <option value=""></option>
                {{#users}}
                <option value="{{user_id}}" {{#is_paid_user}}selected{{/is_paid_user}}>{{FullName}}</option>
                {{/users}}
              </select>
              {{/admin}}
              {{^admin}}
              {{#Bill}}{{PaidUser.FullName}}{{/Bill}}
              {{^Bill}}{{CurrentUser.FullName}}{{/Bill}}
              {{/admin}}
            </td>
          </tr>
          {{#admin}}
          <tr>
            <th>Maksupäivä:</th>
            <td>
              <input type="text" class="datepicker"
                     data-provide="datepicker" data-date-language="fi"
                     name="paid_date_fi"
                     value="{{#Bill}}{{PaidDateFi}}{{/Bill}}">
            </td>
          </tr>
          {{/admin}}
          <tr>
            <th>Kuva:</th>
            <td>
              <button type="button" class="btn" id="image-select-button">Valitse kuva...</button>
              <button type="button" class="btn" id="image-remove-button">Poista kuva</button>
              <button type="button" class="btn" id="image-rotate-button">Kierrä 90&deg;</button>
              <div class="progress" id="image-upload-progress" style="display: none">
                <div id="image-upload-progress-bar" class="progress-bar"
                     role="progressbar" aria-valuenow="0"
                     aria-valuemin="0" aria-valuemax="100"
                     style="width: 0%;"></div>
              </div>
            </td>
          </tr>
          <tr>
            <th>Kulun selvennys:</th>
            <td><textarea name="description" cols="80" rows="4">{{#Bill}}{{description}}{{/Bill}}</textarea></td>
          </tr>
          {{#admin}}
          <tr>
            <th>Summa:</th>
            <td>
              <input type="text" name="amount"
                     value="{{#Bill}}{{amount}}{{/Bill}}"> &euro;
            </td>
          </tr>
          <tr>
            <th>Tilit kirjanpidossa:</th>
            <td>
              <table class="table">
                <tr>
                  <th>Credit (tililtä):</th>
                  <td>
                    <select class="selectpicker" data-width="auto" data-live-search="true" name="credit_account_id">
                      <option value=""></option>
                      {{#credit_accounts}}
                      <option value="{{account_id}}" {{#selected}}selected{{/selected}}>{{prefix}} {{title}}</option>
                      {{/credit_accounts}}
                    </select>
                  </td>
                </tr>
                <tr>
                  <th>Debet (tilille):</th>
                  <td>
                    <select class="selectpicker" data-width="auto" data-live-search="true" name="debit_account_id">
                      <option value=""></option>
                      {{#debit_accounts}}
                      <option value="{{account_id}}" {{#selected}}selected{{/selected}}>{{prefix}} {{title}}</option>
                      {{/debit_accounts}}
                    </select>
                  </td>
                </tr>
              </table>
            </td>
          </tr>
          <tr>
            <th>Tila:</th>
            <td>
              <button type="button" class="btn btn-success">Merkkaa maksetuksi</button>
              <button type="button" class="btn btn-danger">Poista</button>
            </td>
          </tr>
          {{/admin}}
        </table>
        <input type="hidden" id="image-id" name="image_id"
               value="{{#Bill}}{{#images}}{{image_id}}{{/images}}{{/Bill}}">
      </form>
      <form id="image-upload-form" enctype="multipart/form-data"
            style="display: none">
        <input type="file" name="file" id="image-upload-file"
               accept=".jpeg,.jpg,.png,image/jpeg,image/png">
      </form>
      <div id="bill-image-container">
        {{#Bill}}{{#images}}{{#image_id}}
        <img src="/api/userimage/{{image_id}}">
        {{/image_id}}{{/images}}{{/Bill}}
      </div>
      <div id="bill-image-placeholder" class="well">
        <ul>
          <li>Valitse kuva laskusta tai kuitista.
          <li>Kuvasta täytyy näkyä <b>päivämäärä</b> ja <b>summa</b>. Kuittia saa täydentää kirjoittamalla.</li>
          <li>
            Tuetut tiedostomuodot ovat JPEG, PNG ja GIF.</li>
          </li>
        </ul>
      </div>
      <script src="/static/js/jquery.min.js"></script>
      <script src="/static/js/bootstrap.min.js"></script>
      <script src="/static/js/bootstrap-datepicker.min.js"></script>
      <script src="/static/js/bootstrap-datepicker.fi.min.js"></script>
      <script src="/static/js/bootstrap-select.min.js"></script>
      <script src="/static/js/bootstrap-select.fi.min.js"></script>
      <script src="/static/js/jq-ajax-progress.min.js"></script>
      <script src="/static/js/bill.js"></script>
    </div>
  </body>
</html>
